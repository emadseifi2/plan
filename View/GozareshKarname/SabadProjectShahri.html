<div class="row">
    <ul class="col-lg-12" id="SubPortfolio">

        <li style="display: none;" id="[CATEGORYNAME]">
            <span>[TITLE]</span>
            <em>[VALUE]</em>
        </li>

    </ul>
</div>




<style>
    .skin_header,
    .skin_footer {
        display: none;
    }

    #charttree,
    #leftchart {
        width: 100%;
        max-width: 100%;
        direction: ltr;
        height: 41vh;
    }

    #rowcenter1,
    #rowcenter2,
    #rowcenter3,
    #rowcenter4,
    #rowcenter5,
    #rowcenter6,
    #rowcenter7,
    #rowcenter8 {
        width: 100%;
        max-width: 100%;
        direction: ltr;
        height: 25vh;
    }

    #rightA,
    #rightB,
    #rightC,
    #rightD,
    #row2centertop,
    #row2centerdown,
    #row2right {
        width: 100%;
        max-width: 100%;
        direction: ltr;
    }

    #rightA,
    #rightB,
    #rightC,
    #rightD {
        height: 17vh;
    }


    #row2centertop,
    #row2centerdown {
        height: 34vh;
    }

    #row2right {
        height: 34vh;
    }

    body.rtl {
        overflow-y: hidden !important;
    }

    .titletop {
        position: fixed;
        left: 0;
        right: 0;
        top: 0;
        margin: 0 auto;
        text-align: center;
        background-color: rgb(255 255 255);
        width: 25vw !important;
        border-bottom-left-radius: 50px;
        border-bottom-right-radius: 50px;
        padding: 5px 0;
        border-bottom: 1px solid #e1e1e1;
    }

    .legend {
        position: absolute;
        background-color: #18a5e7;
        padding: 5px 10px;
        border-radius: 50px;
        border-bottom: 1px solid #dfdfdf;
        color: #fff;
    }

    .legend-top-left {
        top: 10px;
        left: 70px;
    }

    .legend-top-right {
        top: 10px;
        left: 70px;
    }

    .legend-bottom-right {
        bottom: 50px;
        right: 25px;
    }

    .legend-bottom-left {
        bottom: 50px;
        left: 25px;
    }

    .bg-50-white {
        background-color: #ffffff80;
    }

    .titleimage {
        position: absolute;
        left: -40px;
        background-color: #ffffff;
        padding: 5px 5px;
        border-radius: 200px;
        width: 90px;
        height: 90px;
        border-bottom: 1px solid #e1e1e1;
        top: -10px;
    }

    #dnn_ContentPane {
        display: none;
    }

    #bodyChart {
        display: block;
        width: 100vw;
        height: 100vh;
        z-index: 1;
        background: url(/Portals/2/Econet/Image/Patern/paternrasm2.png), #ffffff !important;
        overflow-y: hidden !important;
    }

    /* //loader css */
    .bodyloader {
        display: block;
        width: 100vw;
        height: 100vh;
        z-index: 9999;
        background: url(/Portals/2/Econet/Image/Patern/paternrasm2.png), #b7b7b7 !important;
        overflow-y: hidden !important;
    }

    .loader {
        position: absolute;
        width: 45px;
        height: 45px;
        background: #076fb4;
        transform: rotateX(65deg) rotate(45deg);
        transform: perspective(200px) rotateX(65deg) rotate(45deg);
        color: #fff;
        animation: layers1 1s linear infinite alternate;
        left: 0;
        right: 0;
        margin: 0 auto;
        top: 30vh;
    }

    .table>thead>tr>th,
    .table>tbody>tr>th,
    .table>tfoot>tr>th,
    .table>thead>tr>td,
    .table>tbody>tr>td,
    .table>tfoot>tr>td {
        padding: 0.5vh 0px !important;
    }

    .loader:after {
        content: '';
        position: absolute;
        inset: 0;
        background: rgba(255, 255, 255, 0.7);
        animation: layerTr 1s linear infinite alternate;
    }

    @keyframes layers1 {
        0% {
            box-shadow: 0px 0px 0 0px
        }

        90%,
        100% {
            box-shadow: 20px 20px 0 -4px
        }
    }

    @keyframes layerTr {
        0% {
            transform: translate(0, 0) scale(1)
        }

        100% {
            transform: translate(-25px, -25px) scale(1)
        }
    }
</style>

<div class="row bodyloader" id="loader">
    <span class="loader"></span>
    <p class="t-medium t-x12 t-fw-200"
        style="position: fixed;left: 0;right: 0;margin: 0 auto;top: 38vh;width: 100%;text-align: center;">ูุทูุง ฺูุฏ ูุญุธู
        ุตุจุฑ ููุงุฏ...</p>
</div>

<section id="bodyChart" style="display: none;">
    <div class="t-center titletop">
        <div class="titleimage">
            <img src="/Portals/2/Econet/Logo/edarekol.png" alt="">
        </div>
        <span class="t-bold t-x7 t-info">
            ฺฉุงุฑูุงูู ุนููฺฉุฑุฏ ุณุจุฏ ูพุฑูฺู ูุง ุดูุฑ
        </span>
        <span class="t-bold t-x7 t-success">
            7
        </span>
        <span class="t-bold t-x7 t-info">
            ูุงู ุณุงู
        </span>
        <span class="t-bold t-x7 t-success">
            1404
        </span>
    </div>
    <div class="row">
        <div class="col-lg-3">
            <div id="leftchart"></div>
            <p class="t-x5 legend legend-top-left t-center">ุฏุฑุตุฏโุชุญูู ุงุฒโุณูู ุณุงู โุฌุงุฑ ุงูุฏุงู</p>
        </div>
        <div class="col-lg-6">
            <div id="charttree"></div>
        </div>
        <div class="col-lg-3">
            <table class="table table-striped rounded bg-50-white;mb-0" style="margin-top: 3vh;">
                <thead>
                    <tr>
                        <th scope="col" class="t-center t-x12 t-fw-200">ููุถูุน</th>
                        <th scope="col" class="t-center t-x12 t-fw-200">ุชุนุฏุงุฏ ุณุจุฏ ุทุฑุญ</th>
                        <th scope="col" class="t-center t-x12 t-fw-200">ุชุนุฏุงุฏ ุณุจุฏ ูพุฑูฺู</th>
                        <th scope="col" class="t-center t-x12 t-fw-200">ุชุนุฏุงุฏ ูพุฑูฺู</th>
                        <th scope="col" class="t-center t-x12 t-fw-200">ูุฒุงู ุชุญูู ฺฉู</th>
                        <th scope="col" class="t-center t-x12 t-fw-200">ูุฒุงู ุชุญูู ุงุฒุณูู ุณุงู ุฌุงุฑ</th>
                        <th scope="col" class="t-center t-x12 t-fw-200">ุงุนุชุจุงุฑ</th>
                        <td style="display: none;" class="t-center t-x12 t-fw-200">PORTFOLIOID</td>
                    </tr>
                </thead>
                <tbody id="Portfolio">


                    <tr id="[CATEGORYNAME]" data-DESIRABLE="[DESIRABLE]" data-ACCEPTABLE="[ACCEPTABLE]"
                        data-WARNING="[WARNING]" data-CRITICAL="[CRITICAL]">
                        <td class="t-center t-x12 t-fw-200" style="width:40%"><span class="data-TITLE">[TITLE]</span></td>
                        <td class="t-center t-x12 t-fw-200"><span class="data-NUMBERDESIGNBASKETS">[NUMBERDESIGNBASKETS]</span>
                        </td>
                        <td class="t-center t-x12 t-fw-200"><span
                                class="data-NUMBERPROJECTPROTFOLIOS">[NUMBERPROJECTPROTFOLIOS]</span></td>
                        <td class="t-center t-x12 t-fw-200"><span class="data-NUMBERPROJECT">[NUMBERPROJECT]</span></td>
                        <td class="t-center t-x12 t-fw-200"><span class="data-TOTALREALIZATIONRATE">[TOTALREALIZATIONRATE]</span>
                        </td>
                        <td class="t-center t-x12 t-fw-200"><span
                                class="data-AMOUNTREALIZATIONRATEYEARS">[AMOUNTREALIZATIONRATEYEARS]</span></td>
                        <td class="t-center t-x12 t-fw-200"><span class="data-CREDIT">[CREDIT]</span></td>
                        <td style="display: none;" class="PORTFOLIOID"><em>[PORTFOLIOID]</em></td>
                    </tr>




                </tbody>
            </table>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-12">
            <div style="display: inline-block;width: 25%">
                <div id="rowcenter1"></div>
                <p class="t-x5 legend t-center" style="top: -10px;">ุฏุฑุตุฏโุชุญููโุงุฒโุณููโุณุงูโุฌุงุฑโุณุจุฏุทุฑุญโฺฉุงูุดโุขููุฏฺฏโููุง</p>
            </div>
            <div style="display: inline-block;width: 11%">
                <div id="rowcenter2"></div>
                <p class="t-x5 legend t-center" style="top: -10px;">ุฏุฑุตุฏโุชุญูู ุงุฒโุณูู ุณุงู โุฌุงุฑ ุงูุฏุงู</p>
            </div>
            <div style="display: inline-block;width: 11%">
                <div id="rowcenter3"></div>
                <p class="t-x5 legend t-center" style="top: -10px;">ุฏุฑุตุฏโุชุญูู ุงุฒโุณูู ุณุงู โุฌุงุฑ ุงูุฏุงู</p>
            </div>
            <div style="display: inline-block;width: 11%">
                <div id="rowcenter4"></div>
                <p class="t-x5 legend t-center" style="top: -10px;">ุฏุฑุตุฏโุชุญูู ุงุฒโุณูู ุณุงู โุฌุงุฑ ุงูุฏุงู</p>
            </div>
            <div style="display: inline-block;width: 14%">
                <div id="rowcenter5"></div>
                <p class="t-x5 legend t-center" style="top: -10px;">ุฏุฑุตุฏโุชุญูู ุงุฒโุณูู ุณุงู โุฌุงุฑ ุงูุฏุงู</p>
            </div>
            <div style="display: inline-block;width: 6%">
                <div id="rowcenter6"></div>
                <p class="t-x5 legend t-center" style="top: -10px;">ุฏุฑุตุฏโุชุญูู ุงุฒโุณูู ุณุงู โุฌุงุฑ ุงูุฏุงู</p>
            </div>
            <div style="display: inline-block;width: 11%">
                <div id="rowcenter7"></div>
                <p class="t-x5 legend t-center" style="top: -10px;">ุฏุฑุตุฏโุชุญูู ุงุฒโุณูู ุณุงู โุฌุงุฑ ุงูุฏุงู</p>
            </div>
            <div style="display: inline-block;width: 8%">
                <div id="rowcenter8"></div>
                <p class="t-x5 legend t-center" style="top: -10px;">ุฏุฑุตุฏโุชุญูู ุงุฒโุณูู ุณุงู โุฌุงุฑ ุงูุฏุงู</p>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-2">
            <div id="row2centerdown"></div>
        </div>
        <div class="col-lg-2">
            <div id="row2centertop"></div>
        </div>
        <div class="col-lg-8">
            <div class="row">
                <div class="col-lg-6">
                    <div id="rightA"></div>
                    <p class="t-x5 legend legend-bottom-right t-center">ุชุนุฏุงุฏ ุณุจุฏ ูพุฑูฺู ูุง</p>
                </div>
                <div class="col-lg-6">
                    <div id="rightB"></div>
                    <p class="t-x5 legend legend-bottom-right t-center">ุชุนุฏุงุฏ ูพุฑูฺู</p>
                </div>
                <div class="col-lg-6">
                    <div id="rightC"></div>
                    <p class="t-x5 legend legend-bottom-right t-center">ุชุนุฏุงุฏ ุณุจุฏ ุทุฑุญ</p>
                </div>
                <div class="col-lg-6">
                    <div id="rightD"></div>
                    <p class="t-x5 legend legend-bottom-right t-center">ูุฒุงู ุงุนุชุจุงุฑ</p>
                </div>
            </div>
        </div>
    </div>
</section>
<script>
    "use strict"
   let SunburstChart = (chartdiv) => {
        // Themes begin
        am4core.useTheme(am4themes_animated);
        // Themes end

        // create chart
        var chart = am4core.create(chartdiv, am4plugins_sunburst.Sunburst);
        chart.padding(0, 0, 0, 0);
        chart.radius = am4core.percent(98);
        chart.padding(0, 0, 0, 0);
        chart.margin(0, 0, 0, 0);

        chart.data = [{
            name: "First",
            children: [
                { name: "A1", value: 100 },
                { name: "A2", value: 60 }
            ]
        },
        {
            name: "Second",
            children: [
                { name: "B1", value: 135 },
                { name: "B2", value: 98 }
            ]
        },
        {
            name: "Third",
            children: [
                {
                    name: "C1",
                    children: [
                        { name: "EE1", value: 130 },
                        { name: "EE2", value: 87 },
                        { name: "EE3", value: 55 }
                    ]
                },
                { name: "C2", value: 148 },
                {
                    name: "C3", children: [
                        { name: "CC1", value: 53 },
                        { name: "CC2", value: 30 }
                    ]
                },
                { name: "C4", value: 26 }
            ]
        },
        {
            name: "Fourth",
            children: [
                { name: "D1", value: 415 },
                { name: "D2", value: 148 },
                { name: "D3", value: 89 }
            ]
        },
        {
            name: "Fifth",
            children: [
                {
                    name: "E1",
                    children: [
                        { name: "EE1", value: 33 },
                        { name: "EE2", value: 40 },
                        { name: "EE3", value: 89 }
                    ]
                },
                {
                    name: "E2",
                    value: 148
                }
            ]
        }];

        chart.colors.step = 2;
        chart.fontSize = 11;
        chart.innerRadius = am4core.percent(10);

        // define data fields
        chart.dataFields.value = "value";
        chart.dataFields.name = "name";
        chart.dataFields.children = "children";


        var level0SeriesTemplate = new am4plugins_sunburst.SunburstSeries();
        level0SeriesTemplate.hiddenInLegend = false;
        chart.seriesTemplates.setKey("0", level0SeriesTemplate)

        // this makes labels to be hidden if they don't fit
        level0SeriesTemplate.labels.template.truncate = true;
        level0SeriesTemplate.labels.template.hideOversized = true;

        level0SeriesTemplate.labels.template.adapter.add("rotation", function (rotation, target) {
            target.maxWidth = target.dataItem.slice.radius - target.dataItem.slice.innerRadius - 10;
            target.maxHeight = Math.abs(target.dataItem.slice.arc * (target.dataItem.slice.innerRadius + target.dataItem.slice.radius) / 2 * am4core.math.RADIANS);

            return rotation;
        })


        var level1SeriesTemplate = level0SeriesTemplate.clone();
        chart.seriesTemplates.setKey("1", level1SeriesTemplate)
        level1SeriesTemplate.fillOpacity = 0.75;
        level1SeriesTemplate.hiddenInLegend = true;

        var level2SeriesTemplate = level0SeriesTemplate.clone();
        chart.seriesTemplates.setKey("2", level2SeriesTemplate)
        level2SeriesTemplate.fillOpacity = 0.5;
        level2SeriesTemplate.hiddenInLegend = true;

        chart.legend = new am4charts.Legend();
        chart.legend.position = "right"; // ๐ ูุฌูุฏ ุณูุช ุฑุงุณุช ูููุฏุงุฑ
        chart.legend.valign = "middle"; // ๐ ุนููุฏ ุฏุฑ ูุณุท ุชุฑุงุฒ ูโุดูุฏ
        chart.legend.margin(0, 20, 0, 0); // ูุงุตูู 20 ูพฺฉุณู ุจู ฺุงุฑุช ู ูุฌูุฏ
        chart.legend.labels.template.truncate = false; // ุงฺฏุฑ ุทูู ููุจูู ุฒุงุฏ ุจูุฏุ ูุทุน ูุดู
        chart.legend.labels.template.wrap = true; // ููุจููโูุง ฺูุฏ ุฎุท ูุฌุงุฒ ุจุงุดู
    }

    let ColumnWithRotatedSeries = (_data, chartdiv, Desirable, Acceptable, Warning, Critical) => {
        am4core.useTheme(am4themes_animated);
        var chart = am4core.create(chartdiv, am4charts.XYChart);
        chart.padding(0, 0, 0, 0);
        chart.margin(0, 0, 0, 0);
        chart.data = _data;

        var categoryAxis = chart.xAxes.push(new am4charts.CategoryAxis());
        categoryAxis.dataFields.category = "title";
        categoryAxis.renderer.grid.template.location = 0.5; // ุจุฑฺุณุจโูุง ุฏุฑ ูุฑฺฉุฒ ุณุชูู
        categoryAxis.renderer.minGridDistance = 30;
        categoryAxis.renderer.labels.template.rotation = 90;
        categoryAxis.renderer.labels.template.fontSize = 10;
        categoryAxis.renderer.labels.template.horizontalCenter = "middle";
        categoryAxis.renderer.labels.template.verticalCenter = "middle";
        categoryAxis.renderer.labels.template.wrap = true;
        categoryAxis.renderer.labels.template.truncate = false;
        categoryAxis.renderer.labels.template.maxWidth = 90;
        categoryAxis.renderer.labels.template.dy = 2;

        var valueAxis = chart.yAxes.push(new am4charts.ValueAxis());
        valueAxis.renderer.minWidth = 50;
        valueAxis.min = 0;
        valueAxis.max = Math.max(Desirable, Acceptable, Warning, Critical) * 1.1; // ูุญุฏูุฏู ูุญูุฑ

        var series = chart.series.push(new am4charts.ColumnSeries());
        series.dataFields.valueY = "value";
        series.dataFields.categoryX = "title";
        series.columns.template.strokeWidth = 0;
        series.columns.template.column.cornerRadiusTopLeft = 10;
        series.columns.template.column.cornerRadiusTopRight = 10;
        series.columns.template.column.fillOpacity = 0.8;
        series.tooltipText = "{categoryX}: [bold]{valueY}[/]";
        series.columns.template.adapter.add("fill", function (fill, target) {
            return chart.colors.getIndex(target.dataItem.index);
        });

        chart.cursor = new am4charts.XYCursor();

        function addThresholdLine(value, label, color) {
            let range = valueAxis.axisRanges.create();
            range.value = value;
            range.grid.stroke = am4core.color(color);
            range.grid.strokeWidth = 1;
            range.grid.strokeDasharray = "3,3";
            range.grid.strokeOpacity = 1;
            range.grid.toFront();

            range.label.text = label + " (" + value + ")";
            range.label.fill = am4core.color(color);
            range.label.fontSize = 10;
            range.label.verticalCenter = "bottom";
            range.label.align = "right";
            range.label.inside = true;
            range.label.toFront();
        }

        chart.events.on("ready", function () {
            addThresholdLine(Desirable, "ุญุฏ ูุทููุจ", "#4CAF50");
            addThresholdLine(Acceptable, "ุญุฏ ูุงุจูโูุจูู", "#2196F3");
            addThresholdLine(Warning, "ุญุฏ ูุดุฏุงุฑ", "#FFC107");
            addThresholdLine(Critical, "ุญุฏ ุจุญุฑุงู", "#F44336");
        });
    };

    let LollipopChart = (data, chartdiv, Desirable, Acceptable, Warning, Critical) => {
        am4core.useTheme(am4themes_animated);

        // ๐ฆ ุงุฌุงุฏ ฺุงุฑุช
        var chart = am4core.create(chartdiv, am4charts.XYChart);
        chart.data = data;

        // ๐ ุงุฑุชูุงุน container ุฏุฑ CSS ุซุงุจุช (ูุซูุงู height: 30vh)
        // โ ุชูุธู ุฏูุงูฺฉ plot container ุจุฑุง ุญูุธ ูุงุญูโ ูููุฏุงุฑ ูุงูุน
        chart.events.on("ready", function () {
            // ููุช ฺุงุฑุช ุขูุงุฏู ุดุฏุ ุงุฑุชูุงุน plot ุฑุง ุชูุธู ูโฺฉูู
            const totalHeight = chart.svgContainer.htmlElement.clientHeight; // 30vh ูุนุงุฏู ูพฺฉุณู
            const axisLabelSpace = totalHeight * 0.17; // ุญุฏูุฏ 5vh (ุชูุฑุจุงู 17%)
            const plotHeight = totalHeight - axisLabelSpace; // 25vh ุจุงู ุจูุงูุฏ
            chart.plotContainer.pixelHeight = plotHeight;
        });

        // ุฌููฺฏุฑ ุงุฒ ุชุบุฑ ุฎูุฏฺฉุงุฑ responsive
        chart.responsive.enabled = false;

        // --- ูุญูุฑ ุงูู ---
        var categoryAxis = chart.xAxes.push(new am4charts.CategoryAxis());
        categoryAxis.dataFields.category = "category";
        categoryAxis.renderer.grid.template.location = 0;
        categoryAxis.renderer.minGridDistance = 20;

        // 9๏ธโฃฐ ุฏุฑุฌู ูุงูุฏู ุจุฑฺุณุจโูุง
        categoryAxis.renderer.labels.template.rotation = 90;
        categoryAxis.renderer.labels.template.horizontalCenter = "middle";
        categoryAxis.renderer.labels.template.verticalCenter = "middle";
        categoryAxis.renderer.labels.template.fontSize = 9;
        categoryAxis.renderer.labels.template.wrap = true;
        categoryAxis.renderer.labels.template.truncate = false;
        categoryAxis.renderer.labels.template.maxWidth = 80;
        categoryAxis.renderer.labels.template.dy = 2;

        // --- ูุญูุฑ ุนููุฏ ---
        var valueAxis = chart.yAxes.push(new am4charts.ValueAxis());
        valueAxis.tooltip.disabled = true;
        valueAxis.renderer.ticks.template.disabled = true;
        valueAxis.renderer.axisFills.template.disabled = true;

        // --- ุณุฑ ---
        var series = chart.series.push(new am4charts.ColumnSeries());
        series.dataFields.categoryX = "category";
        series.dataFields.valueY = "value";
        series.tooltipText = "{category}: {valueY.value}";
        series.fillOpacity = 0;
        series.strokeOpacity = 1;
        series.strokeDashArray = "1,3";
        series.columns.template.width = 0.01;

        var bullet = series.bullets.create(am4charts.CircleBullet);
        chart.cursor = new am4charts.XYCursor();

        // --- ุฎุทูุท ุญุฏ ---
        function addThresholdLine(value, label, color) {
            let range = valueAxis.axisRanges.create();
            range.value = value;
            range.grid.stroke = am4core.color(color);
            range.grid.strokeWidth = 1;
            range.grid.strokeOpacity = 1;
            range.grid.strokeDasharray = "3,3";
            range.grid.toFront();

            range.label.inside = true;
            range.label.text = label + " (" + value + ")";
            range.label.fill = am4core.color(color);
            range.label.fontSize = 9;
            range.label.verticalCenter = "center";
            range.label.align = "center";
            range.label.toFront();
        }

        addThresholdLine(Desirable, "ุญุฏ ูุทููุจ", "#4CAF50");
        addThresholdLine(Acceptable, "ุญุฏ ูุงุจูโูุจูู", "#2196F3");
        addThresholdLine(Warning, "ุญุฏ ูุดุฏุงุฑ", "#FFC107");
        addThresholdLine(Critical, "ุญุฏ ุจุญุฑุงู", "#F44336");
    };

    let PieChartWithLegend = (chartdiv) => {

        // Themes begin
        am4core.useTheme(am4themes_animated);
        // Themes end

        var data = [
            { "title": "Lithuania", "value": 501.9 },
            { "title": "Estonia", "value": 301.9 },
            { "title": "Ireland", "value": 201.1 },
            { "title": "Germany", "value": 165.8 },
            { "title": "Australia", "value": 139.9 },
            { "title": "Austria", "value": 128.3 }
        ];

        // ููุท ฺฉ ฺุงุฑุช ุณุงุฏู ูโุฎูุงูู
        var chart = am4core.create(chartdiv, am4charts.PieChart);
        chart.fontSize = 11;
        chart.hiddenState.properties.opacity = 0; // fade-in
        chart.radius = am4core.percent(70);
        chart.innerRadius = am4core.percent(40);

        // ุฏุงุฏูโูุง
        chart.data = data;

        // ุณุฑ
        var series = chart.series.push(new am4charts.PieSeries());
        series.dataFields.value = "value";
        series.dataFields.category = "title";
        series.colors.step = 2;
        series.alignLabels = false;
        series.labels.template.bent = true;
        series.labels.template.radius = 3;
        series.labels.template.padding(0, 0, 0, 0);
        series.ticks.template.disabled = true;

        // ุชูุธูุงุช ุธุงูุฑ ุจุฑุดโูุง (slices)
        var sliceTemplate = series.slices.template;
        sliceTemplate.cornerRadius = 5;
        sliceTemplate.strokeWidth = 1;
        sliceTemplate.strokeOpacity = 1;
        sliceTemplate.draggable = false; // ฺูู ุฏฺฏู drag ูุงุฒู ูุฏุงุฑู
        sliceTemplate.inert = true;
        sliceTemplate.cursorOverStyle = [{ property: "cursor", value: "pointer" }];

        // ฺฏุฒููโูุง ุฑูฺฏ ุงุฎุชุงุฑ
        chart.colors.list = [
            am4core.color("#4CAF50"),
            am4core.color("#2196F3"),
            am4core.color("#FFC107"),
            am4core.color("#E91E63"),
            am4core.color("#9C27B0"),
            am4core.color("#FF5722")
        ];

        // ุณุงู hover
        var shadow = sliceTemplate.filters.push(new am4core.DropShadowFilter);
        shadow.opacity = 0;
        var hoverState = sliceTemplate.states.getKey("hover");
        var hoverShadow = hoverState.filters.push(new am4core.DropShadowFilter);
        hoverShadow.opacity = 0.7;
        hoverShadow.blur = 5;

    }

    let horizontalChart = (_data, chartdiv) => {
        am4core.useTheme(am4themes_animated);

        var chart = am4core.create(chartdiv, am4charts.XYChart);

        // ุญุฐู ุญุงุดู ู ูุงุตูู ุงุถุงู
        chart.padding(0, 0, 0, 0);
        chart.margin(0, 0, 0, 0);

        // ๐ ุฏุงุฏูโูุง
        chart.data = _data
        // ๐น ูุญูุฑ ุฏุณุชูโูุง (ุนููุฏ)
        var categoryAxis = chart.yAxes.push(new am4charts.CategoryAxis());
        categoryAxis.dataFields.category = "title";
        categoryAxis.renderer.grid.template.location = 0;
        categoryAxis.renderer.inversed = true;
        categoryAxis.renderer.minGridDistance = 10;
        categoryAxis.renderer.inside = false;

        // ๐ค ุชูุธู ุธุงูุฑ Labelูุง
        categoryAxis.renderer.labels.template.truncate = false;
        categoryAxis.renderer.labels.template.wrap = true;
        categoryAxis.renderer.labels.template.maxWidth = 200;
        categoryAxis.renderer.labels.template.fontSize = 9;
        categoryAxis.renderer.labels.template.horizontalCenter = "middle";
        categoryAxis.renderer.labels.template.verticalCenter = "middle";
        categoryAxis.renderer.labels.template.fillOpacity = 1;
        categoryAxis.renderer.minWidth = 200;

        // ๐น ูุญูุฑ ููุงุฏุฑ (ุงูู)
        var valueAxis = chart.xAxes.push(new am4charts.ValueAxis());
        valueAxis.renderer.minGridDistance = 40;
        valueAxis.renderer.minHeight = 40;
        valueAxis.renderer.labels.template.fontSize = 11;
        valueAxis.renderer.labels.template.fillOpacity = 0.8;
        valueAxis.renderer.grid.template.strokeOpacity = 0.15;

        // ๐น ุณุฑ ุณุชููโูุง
        var series = chart.series.push(new am4charts.ColumnSeries());
        series.dataFields.valueX = "value";
        series.dataFields.categoryY = "title";
        series.sequencedInterpolation = true;
        series.tooltipText = "{categoryY}: [bold]{valueX}[/]";
        series.columns.template.strokeWidth = 0;
        series.columns.template.height = am4core.percent(60);
        series.columns.template.column.cornerRadiusTopLeft = 10;
        series.columns.template.column.cornerRadiusBottomLeft = 10;

        // ๐ธ ุญุงูุช Hover
        var hoverState = series.columns.template.column.states.create("hover");
        hoverState.properties.cornerRadiusTopLeft = 0;
        hoverState.properties.cornerRadiusBottomLeft = 0;
        hoverState.properties.fillOpacity = 1;

        // ๐จ ุฑูฺฏ ุฒุฏู ุฎูุฏฺฉุงุฑ
        series.columns.template.adapter.add("fill", function (fill, target) {
            return chart.colors.getIndex(target.dataItem.index);
        });

        // ๐ซ ุญุฐู ุฑูุชุงุฑ ฺฉุดุฏู/ูพุงู
        chart.cursor = new am4charts.XYCursor();
        chart.cursor.behavior = "none";
    };

    let CurvedColumns = (_data, chartdiv, Desirable, Acceptable, Warning, Critical) => {
        // Themes begin
        am4core.useTheme(am4themes_animated);

        var chart = am4core.create(chartdiv, am4charts.XYChart);
        chart.hiddenState.properties.opacity = 0; // this makes initial fade in effect
        chart.padding(0, 0, 0, 0);
        chart.margin(0, 0, 0, 0);

        // chart.data = [{
        // "title": "One",
        // "value": 3025
        // }];

        chart.data = _data;
        var categoryAxis = chart.xAxes.push(new am4charts.CategoryAxis());
        categoryAxis.renderer.grid.template.location = 0;
        categoryAxis.dataFields.category = "title";
        categoryAxis.renderer.minGridDistance = 40;
        categoryAxis.renderer.labels.template.rotation = 90;
        categoryAxis.renderer.labels.template.horizontalCenter = "middle";
        categoryAxis.renderer.labels.template.verticalCenter = "middle";
        categoryAxis.renderer.labels.template.fontSize = 9;
        categoryAxis.renderer.labels.template.wrap = true;
        categoryAxis.renderer.labels.template.truncate = false;
        categoryAxis.renderer.labels.template.maxWidth = 90;
        categoryAxis.renderer.labels.template.dy = 2;

        var valueAxis = chart.yAxes.push(new am4charts.ValueAxis());

        var series = chart.series.push(new am4charts.CurvedColumnSeries());
        series.dataFields.categoryX = "title";
        series.dataFields.valueY = "value";
        series.tooltipText = "{valueY.value}"
        series.columns.template.strokeOpacity = 0;

        series.columns.template.fillOpacity = 0.75;

        var hoverState = series.columns.template.states.create("hover");
        hoverState.properties.fillOpacity = 1;
        hoverState.properties.tension = 0.4;

        chart.cursor = new am4charts.XYCursor();

        // Add distinctive colors for each column using adapter
        series.columns.template.adapter.add("fill", function (fill, target) {
            return chart.colors.getIndex(target.dataItem.index);
        });

        // --- ุฎุทูุท ุญุฏ ---
        function addThresholdLine(value, label, color) {
            let range = valueAxis.axisRanges.create();
            range.value = value;
            range.grid.stroke = am4core.color(color);
            range.grid.strokeWidth = 1;
            range.grid.strokeOpacity = 1;
            range.grid.strokeDasharray = "3,3";
            range.grid.toFront();

            range.label.inside = true;
            range.label.text = label + " (" + value + ")";
            range.label.fill = am4core.color(color);
            range.label.fontSize = 9;
            range.label.verticalCenter = "center";
            range.label.align = "center";
            range.label.toFront();
        }

        addThresholdLine(Desirable, "ุญุฏ ูุทููุจ", "#4CAF50");
        addThresholdLine(Acceptable, "ุญุฏ ูุงุจูโูุจูู", "#2196F3");
        addThresholdLine(Warning, "ุญุฏ ูุดุฏุงุฑ", "#FFC107");
        addThresholdLine(Critical, "ุญุฏ ุจุญุฑุงู", "#F44336");
    }

    am4core.ready(function () {
        PieChartWithLegend('row2centertop');
        PieChartWithLegend('row2centerdown');
        document.getElementById('bodyChart').style.display = 'block';
        document.getElementById('loader').style.display = 'none';

        // ุชุนุฑู ุขุฑุงูโูุง ุฏุณุชูโูุง
        var allLimit = [];

        var dataChartAMOUNTREALIZATIONRATEYEARS = []; //ูุฒุงู ุชุญูู ุงุฒุณูู ุณุงู ุฌุงุฑ	
        var dataChartNUMBERPROJECTPROTFOLIOS = []; //ุชุนุฏุงุฏ ุณุจุฏ ูพุฑูฺู	
        var dataChartNUMBERPROJECT = []; //ุชุนุฏุงุฏ ูพุฑูฺู	
        var dataChartNUMBERDESIGNBASKETS = []; //ุชุนุฏุงุฏ ุณุจุฏ ุทุฑุญ	
        var dataChartCREDIT = []; //ุงุนุชุจุงุฑ

        var tarhKaheshAloodegiHava = [];
        var behbodToseeModiriatSazman = [];
        var modiriatBohranAfzayeshImeniShahr = [];
        var behbodFarhangOmoomiTakhasosi = [];
        var afzayeshRefahMogabeleGarani = [];
        var taghviyatKhanevadeToseeBanovan = [];
        var modiriatManabeTabiei = [];
        var zibasaziSimayeBasariShahr = [];
        var Desirable = 0;
        var Acceptable = 0;
        var Warning = 0;
        var Critical = 0;

        // ฺฏุฑูุชู ุฏุงุฏูโูุง ุงุฒ HTML
        const Portfolio = document.querySelectorAll("#Portfolio tr");
        const SubPortfolio = document.querySelectorAll("#SubPortfolio li");
        let FirstLevel = [];
        // ูพูุงุด ุชูุงู Portfolioูุง
        Portfolio.forEach(port => {
            const titleElem = port.querySelector(".data-TITLE");
            const titleText = titleElem ? titleElem.textContent.trim() : "ุจุฏูู ุนููุงู";

            const emElem = port.querySelector("em");
            const PORTFOLIOID = emElem ? emElem.textContent.trim() : "";

            // ููุชุฑ ุฒุฑ ุดุงุฎูโูุง ุจุฑ ุงุณุงุณ id
            const matchingSub = Array.from(SubPortfolio).filter(li => li.id === PORTFOLIOID);

            // ุณุงุฎุช ุณุทุญ ุณูู (children)
            let SecondLevel = matchingSub.map(li => {
                const span = li.querySelector("span");
                const em = li.querySelector("em");
                let nameText = span.textContent.trim()
                var shortName = nameText.length > 10 ? nameText.substring(0, 10) + "โฆ" : nameText;

                return {
                    name: span ? span.textContent.trim() : "ุจุฏูู ูุงู",
                    shortName: shortName,
                    value: em ? parseFloat(em.textContent.trim()) || 0 : 0
                };
            });

            // ุงูุฒูุฏู ุณุทุญ ุฏูู
            FirstLevel.push({
                name: titleText,
                children: SecondLevel
            });
        });
        const DataFirstLevel = {
            name: "ุณุจุฏ ูพุฑูฺูโูุง",
            children: FirstLevel
        };
        DataForceDirectedTree.push(DataFirstLevel);
        console.log(DataForceDirectedTree);

        for (let p = 0; p < Portfolio.length; p++) {
            const elmPortfolio = Portfolio[p];
            const portfolioId = elmPortfolio.id;
            let em = elmPortfolio.querySelector("em");
            let PORTFOLIOID = em.textContent.trim();

            const _desirable = parseFloat(elmPortfolio.getAttribute("data-DESIRABLE")) || 0;
            const _acceptable = parseFloat(elmPortfolio.getAttribute("data-ACCEPTABLE")) || 0;
            const _warning = parseFloat(elmPortfolio.getAttribute("data-WARNING")) || 0;
            const _critical = parseFloat(elmPortfolio.getAttribute("data-CRITICAL")) || 0;

            const titles = elmPortfolio.querySelector('.data-TITLE');
            const NUMBERDESIGNBASKETS = elmPortfolio.querySelector('.data-NUMBERDESIGNBASKETS');
            const NUMBERPROJECTPROTFOLIOS = elmPortfolio.querySelector('.data-NUMBERPROJECTPROTFOLIOS');
            const NUMBERPROJECT = elmPortfolio.querySelector('.data-NUMBERPROJECT');
            const TOTALREALIZATIONRATE = elmPortfolio.querySelector('.data-TOTALREALIZATIONRATE');
            const AMOUNTREALIZATIONRATEYEARS = elmPortfolio.querySelector('.data-AMOUNTREALIZATIONRATEYEARS');
            const CREDIT = elmPortfolio.querySelector('.data-CREDIT');

            const limit = {
                Title: PORTFOLIOID,
                Desirable: _desirable,
                Acceptable: _acceptable,
                Warning: _warning,
                Critical: _critical
            };

            const data = {
                title: titles ? titles.textContent.trim() : "",
                value: AMOUNTREALIZATIONRATEYEARS ? parseFloat(AMOUNTREALIZATIONRATEYEARS.textContent.trim()) || 0 : 0
            };

            const dataNUMBERPROJECTPROTFOLIOS = {
                title: titles ? titles.textContent.trim() : "",
                value: NUMBERPROJECTPROTFOLIOS ? parseFloat(NUMBERPROJECTPROTFOLIOS.textContent.trim()) || 0 : 0
            };

            const dataNUMBERPROJECT = {
                title: titles ? titles.textContent.trim() : "",
                value: NUMBERPROJECT ? parseFloat(NUMBERPROJECT.textContent.trim()) || 0 : 0
            };

            const dataNUMBERDESIGNBASKETS = {
                title: titles ? titles.textContent.trim() : "",
                value: NUMBERDESIGNBASKETS ? parseFloat(NUMBERDESIGNBASKETS.textContent.trim()) || 0 : 0
            };

            const dataCREDIT = {
                title: titles ? titles.textContent.trim() : "",
                value: CREDIT ? parseFloat(CREDIT.textContent.trim()) || 0 : 0
            };

            allLimit.push(limit);
            dataChartAMOUNTREALIZATIONRATEYEARS.push(data);
            dataChartNUMBERPROJECTPROTFOLIOS.push(dataNUMBERPROJECTPROTFOLIOS); //ุชุนุฏุงุฏ ุณุจุฏ ูพุฑูฺู	
            dataChartNUMBERPROJECT.push(dataNUMBERPROJECT);
            dataChartNUMBERDESIGNBASKETS.push(dataNUMBERDESIGNBASKETS);
            dataChartCREDIT.push(dataCREDIT);
        }

        for (let i = 0; i < SubPortfolio.length; i++) {
            const element = SubPortfolio[i];

            // ฺฏุฑูุชู ููุงุฏุฑ span ู em (ุฏุฑ ุตูุฑุช ูุฌูุฏ)
            let span = element.querySelector("span");
            let em = element.querySelector("em");
            if (!span || !em) continue; // ุงฺฏุฑ ุฎุงู ุจูุฏูุ ุจุฑู ุจู ููุฑุฏ ุจุนุฏ

            let title = span.textContent.trim();
            let value = parseFloat(em.textContent.trim()) || 0;

            const data = {
                title,
                value
            };

            // โ ููุงุณู ุจุฑ ุงุณุงุณ id ุงููุงู
            switch (element.id) {
                case "tarhKaheshAloodegiHava":
                    tarhKaheshAloodegiHava.push(data);
                    break;
                case "behbodToseeModiriatSazman":
                    behbodToseeModiriatSazman.push(data);
                    break;
                case "modiriatBohranAfzayeshImeniShahr":
                    modiriatBohranAfzayeshImeniShahr.push(data);
                    break;
                case "behbodFarhangOmoomiTakhasosi":
                    behbodFarhangOmoomiTakhasosi.push(data);
                    break;
                case "afzayeshRefahMogabeleGarani":
                    afzayeshRefahMogabeleGarani.push(data);
                    break;
                case "taghviyatKhanevadeToseeBanovan":
                    taghviyatKhanevadeToseeBanovan.push(data);
                    break;
                case "modiriatManabeTabiei":
                    modiriatManabeTabiei.push(data);
                    break;
                case "zibasaziSimayeBasariShahr":
                    zibasaziSimayeBasariShahr.push(data);
                    break;
            }
        }

        for (let t = 0; t < allLimit.length; t++) {
            const elementLimit = allLimit[t];
            if (elementLimit.Title === "tarhKaheshAloodegiHava") {
                CurvedColumns(tarhKaheshAloodegiHava, 'rowcenter1', elementLimit.Desirable, elementLimit.Acceptable, elementLimit.Warning, elementLimit.Critical);
            } else if (elementLimit.Title === "behbodToseeModiriatSazman") {
                CurvedColumns(behbodToseeModiriatSazman, 'rowcenter2', elementLimit.Desirable, elementLimit.Acceptable, elementLimit.Warning, elementLimit.Critical);
            } else if (elementLimit.Title === "modiriatBohranAfzayeshImeniShahr") {
                CurvedColumns(modiriatBohranAfzayeshImeniShahr, 'rowcenter3', elementLimit.Desirable, elementLimit.Acceptable, elementLimit.Warning, elementLimit.Critical);
            } else if (elementLimit.Title === "behbodFarhangOmoomiTakhasosi") {
                CurvedColumns(behbodFarhangOmoomiTakhasosi, 'rowcenter4', elementLimit.Desirable, elementLimit.Acceptable, elementLimit.Warning, elementLimit.Critical);
            } else if (elementLimit.Title === "afzayeshRefahMogabeleGarani") {
                CurvedColumns(afzayeshRefahMogabeleGarani, 'rowcenter5', elementLimit.Desirable, elementLimit.Acceptable, elementLimit.Warning, elementLimit.Critical);
            } else if (elementLimit.Title === "taghviyatKhanevadeToseeBanovan") {
                CurvedColumns(taghviyatKhanevadeToseeBanovan, 'rowcenter6', elementLimit.Desirable, elementLimit.Acceptable, elementLimit.Warning, elementLimit.Critical);
            } else if (elementLimit.Title === "modiriatManabeTabiei") {
                CurvedColumns(modiriatManabeTabiei, 'rowcenter7', elementLimit.Desirable, elementLimit.Acceptable, elementLimit.Warning, elementLimit.Critical);
            } else if (elementLimit.Title === "zibasaziSimayeBasariShahr") {
                CurvedColumns(zibasaziSimayeBasariShahr, 'rowcenter8', elementLimit.Desirable, elementLimit.Acceptable, elementLimit.Warning, elementLimit.Critical);
            }
        }

        ColumnWithRotatedSeries(dataChartAMOUNTREALIZATIONRATEYEARS, 'leftchart', 80, 70, 50, 40);
        horizontalChart(dataChartNUMBERPROJECTPROTFOLIOS, 'rightA');
        horizontalChart(dataChartNUMBERPROJECT, 'rightB');
        horizontalChart(dataChartNUMBERDESIGNBASKETS, 'rightC');
        horizontalChart(dataChartCREDIT, 'rightD');
    }); // end am4core.ready()
</script>